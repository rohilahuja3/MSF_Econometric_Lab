# -*- coding: utf-8 -*-
"""
This code performs several analysis for the mean-variance portfolio analysis
"""

import numpy as np # Need to load this module to perform matrix multiplication
import matplotlib.pyplot as plt
from scipy import optimize

"Input DATA"

" Here is return data (in percentage) for 6 assets "
Ret= np.array([
(3.964, 1.875, 3.144, 1.712, 6.33, 2.313), 
(4.979, 4.192, 3.12, 2.865, 10.162, 8.092), 
(0.348, 2.789, 6.141, 4.169, 3.249, 5.657), 
(4.34, 3.957, 5.88, 3.467, 8.602, 4.132), 
(1.093, 0.993, 2.892, 0.655, 8.406, 12.847), 
(5.643, 3.065, 3.282, 3.557, 14.155, -1.874), 
(6.767, 4.644, 3.993, 3.356, 0.187, 1.143), 
(2.264, 2.431, 0.831, -0.577, 5.298, 1.927), 
(-2.647, 1.698, -4.126, -2.439, -0.792, 1.409), 
(1.01, 2.193, 3.762, 2.464, 9.428, 4.417), 
(-7.26, -6.363, -9.303, -7.302, -13.624, -8.149), 
(-3.474, -2.804, 0.432, -0.871, 1.128, -0.07), 
(-1.317, -1.875, -1.513, -2.609, -2.419, -2.158), 
(-10.372, -7.003, -8.814, -8.856, -5.696, -9.656), 
(-1.008, -3.127, -2.884, -3.379, -6.111, -3.45), 
(0.227, 2.692, 1.07, 1.566, -1.957, 0.771), 
(1.295, 3.564, 1.09, 5.157, 6.985, 7.882), 
(0.924, -1.197, 1.661, 2.053, 4.801, 8.013), 
(12.1, 11.793, 14.98, 12.854, 21.591, 13.296), 
(1.806, 3.365, 0.605, 1.002, 0.198, 3.653), 
(4.597, 2.455, 8.739, 4.951, 7.981, 9.293), 
(4.261, 7.889, 3.177, 2.562, 7.21, 5.271), 
(-1.432, -5.117, -3.77, -3.29, -4.305, -5.462), 
(7.954, 3.739, 6.421, 3.236, 12.813, 7.11), 
(9.16, 4.472, 8.008, 5.907, 4.388, 2.333), 
(0.569, -0.356, 0.502, -0.529, -1.294, -2.533), 
(5.931, 4.959, 2.807, 3.543, 7.15, 4.372), 
(-4.671, -2.356, -5.737, -6.306, -3.454, -5.488), 
(0.222, -0.44, -0.957, 0.418, -1.316, 1.801), 
(8.949, 2.183, 5.953, 4.556, 6.861, 3.996), 
(0.643, -0.985, 0.149, -4.13, -2.274, -7.76), 
(-3.684, -2.136, -3.779, -5.311, -6.793, -7.85), 
(0.937, 1.79, -1.817, -0.288, 0.243, -1.003), 
(16.141, 11.844, 13.279, 11.505, 11.467, 15.69), 
(5.708, 5.571, 5.379, 3.381, 4.843, 1.772), 
(3.488, -0.064, 1.329, 0.051, -0.339, -0.243), 
(-4.006, -6.013, -0.831, -5.529, -7.695, -9.576), 
(3.782, 1.76, 5.128, 2.332, 4.35, 3.238), 
(9.281, 5.569, 5.896, 3.468, 7.658, 6.695), 
(1.765, 2.292, 1.369, 0.694, -0.912, -1.783), 
(5.222, 5.151, 6.306, 6.659, 6.42, 8.771), 
(-0.769, -2.597, 0.27, -1.516, -2.073, -4.409), 
(-2.606, -2.822, -2.437, -1.083, -2.733, -5.5), 
(-7.976, -6.975, -7.598, -8.272, -8.182, -8.695), 
(1.537, 0.654, 3.38, 2.821, 0.891, 1.829), 
(0.579, 2.109, -0.321, -0.045, 0.723, 2.241), 
(-0.669, -1.419, 0.197, -1.923, 0.321, -0.617), 
(-10.948, -9.219, -11.802, -10.533, -11.623, -9.483), 
(-10.149, -8.286, -8.509, -8.273, -8.828, -12.486), 
(2.21, 6.238, 2.783, 5.133, 3.665, 7.074), 
(-3.598, -1.507, -3.793, -3.891, -0.857, -1.517), 
(7.869, 9.166, 5.416, 5.455, 8.586, 10.807), 
(-6.04, -4.622, -5.722, -4.828, -4.784, -5.894), 
(-7.179, -4.544, -6.218, -4.439, -5.923, -4.724), 
(-4.367, -7.131, -3.928, -7.519, -3.482, -12.122), 
(2.978, 2.127, 5.764, 4.095, 7.561, 0.378), 
(1.096, 0.068, -0.103, -1.485, -2.539, -5.949), 
(-10.881, -14.868, -11.717, -14.917, -13.069, -19.477), 
(-10.118, -11.505, -8.31, -8.47, -8.644, -14.069), 
(-7.279, -6.034, -8.17, -6.782, -8.976, -10.816), 
(8.726, 9.944, 5.888, 6.062, 2.566, 1.197), 
(5.112, 5.126, 7.268, 4.934, 3.632, 10.219), 
(9.363, 6.492, 6.237, 7.913, 15.934, 15.801), 
(-4.699, -2.806, -7.539, -4.756, -10.834, -9.509), 
(0.961, 3.968, 1.036, 1.9, 0.912, -0.753), 
(13.229, 8.566, 8.817, 7.94, 7.652, 6.047), 
(11.845, 9.315, 11.095, 8.286, 19.094, 11.412), 
(4.825, 3.634, 2.047, 2.273, -0.573, 2.188), 
(6.132, 7.433, 3.59, 5.046, 8.919, 9.73), 
(3.006, 4.91, 3.675, 4.289, 2.387, 3.412), 
(-5.087, -4.086, -5.215, -4.777, -5.585, -5.154), 
(-1.717, 0.657, -3.652, -1.368, -3.527, -3.421), 
(-5.402, -5.121, -5.903, -4.536, -8.649, -8.256), 
(5.978, 4.827, 5.978, 4.792, 4.201, 5.758), 
(-1.43, 0.162, -3.884, -1.684, -3.78, -3.696), 
(-4.638, -4.45, -7.805, -6.855, -7.13, -9.983), 
(-3.829, -1.22, -4.104, -2.995, -2.313, 0.027), 
(11.486, 9.399, 12.007, 10.886, 15.7, 14.844), 
(8.593, 4.786, 8.974, 3.532, 18.474, 7.461), 
(3.951, 5.275, 3.415, 5.006, 7.037, 4.727), 
(-1.087, 0.839, -0.336, -0.412, -0.437, -1.433), 
(1.299, 0.538, 2.828, 1.767, 1.261, -0.086), 
(-3.946, -0.2, -2.103, -0.435, -1.963, -1.087), 
(-3.886, -3.956, -3.765, -3.392, -2.468, -2.739), 
(-4.694, -3.894, -1.218, -3.212, -3.928, -1.949), 
(0.061, -0.887, 4.489, 3.206, 3.489, -0.577), 
(-4.674, -2.759, -4.33, -3.096, -4.037, -3.51), 
(-0.008, -1.51, -1.65, -1.712, -2.715, -0.672), 
(5.003, 5.147, 7.622, 4.333, 4.546, 2.86), 
(-2.876, -0.822, -2.589, -0.838, -2.805, -1.293), 
(-4.402, -8.954, -2.449, -4.019, -5.611, -7.666), 
(-6.957, -8.968, -5.442, -7.28, -6.764, -9.929), 
(-2.987, -2.014, -0.031, -2.842, -3.243, -6.305), 
(-5.064, -9.678, -4.246, -5.311, -4.95, -9.409), 
(-10.091, -7.334, -7.579, -7.188, -10.907, -8.11), 
(-4.417, -5.471, -2.514, -3.78, -1.649, -2.187), 
(9.195, 13.96, 10.763, 12.299, 13.479, 14.591), 
(-5.98, -4.799, -3.284, -4.112, -7.136, -5.868), 
(5.089, 9.235, 9.303, 9.483, 9.484, 11.092), 
(-1.004, -3.611, 1.914, 2.907, 1.167, -2.778), 
(-20.098, -22.222, -17.942, -17.037, -22.899, -22.097), 
(-5.866, -5.464, -0.795, -0.802, -4.999, -4.978), 
(16.3, 8.32, 13.733, 6.285, 17.754, 10.492), 
(2.745, 0.917, 1.9, -0.178, -0.912, 1.189), 
(0.488, 0.485, 1.016, -1.107, -2.27, -3.938), 
(-3.593, -5.976, -3.069, -5.559, -5.396, -7.228), 
(-7.944, -5.699, -7.86, -7.962, -7.728, -6.973), 
(-4.718, -3.581, -1.023, -1.97, -4.987, -5.335), 
(-3.912, -6.747, -2.634, -5.602, -6.88, -10.593), 
(-8.604, -9.675, -6.378, -9.966, -8.209, -9.169), 
(-10.114, -10.906, -7.288, -10.837, -10.058, -15.281), 
(5.519, 10.102, 8.789, 15.565, 6.931, 9.98), 
(-6.088, -6.138, -5.528, -3.899, -4.668, -3.749), 
(-10.911, -6.015, -7.93, -6.658, -8.164, -10.426), 
(33.245, 29.106, 28.233, 18.852, 39.618, 28.38), 
(3.879, 4.879, 4.771, 3.989, 5.123, 9.07), 
(10.649, 10.764, 5.962, 5.324, 10.131, 13.239), 
(2.897, 4.379, 3.696, 7.938, 8.072, 4.306), 
(5.598, 6.06, 5.596, 6.456, 10.764, 7.144), 
(7.32, 5.926, 6.15, 6.023, 7.855, 6.899), 
(1.535, -2.759, -2.35, -3.979, -3.722, -7.848), 
(-6.523, -5.429, -5.203, -3.077, -9.144, -7.013), 
(-4.808, -4.031, -3.947, -5.06, -3.945, -5.358), 
(3.459, 5.821, 0.426, 0.121, 0.435, 2.216), 
(3.884, 3.642, 2.083, 1.746, -1.075, 2.177), 
(0.142, -1.257, -1.601, -0.966, -1.804, -2.246), 
(26.063, 16.402, 23.315, 17.676, 30.805, 20.29), 
(17.789, 5.136, 13.644, 4.745, 18.835, 8.334), 
(0.424, 0.625, 1.762, 1.625, 0.473, 2.344), 
(-0.14, -0.75, -0.088, -0.43, -2.782, -1.858), 
(-5.334, -3.117, -1.086, 0.647, -3.678, -1.79), 
(2.218, 1.724, 3.815, 3.599, 7.778, 4.929), 
(0.975, -0.205, -0.005, -0.907, -2.059, -1.915), 
(-3.88, -2.351, -1.843, -1.937, -3.426, -2.69), 
(-0.899, 1.85, 1.562, 2.558, 1.348, 0.519), 
(-3.32, -2.26, -2.69, -3.279, -6.278, -3.854), 
(1.839, 3.381, 2.683, 0.88, 2.899, 0.833), 
(9.704, 7.269, 8.357, 7.968, 12.667, 11.986), 
(4.512, -2.103, 5.268, 0.026, 3.419, -1.816), 
(0.32, -1.381, -0.011, -1.074, 0.911, -1.454), 
(0.004, -0.754, 1.667, 0.394, 2.74, -0.051), 
(3.473, 0.388, 2.485, 1.321, 3.916, 1.006), 
(-0.19, -0.842, -0.032, -1.284, -2.198, 0.096), 
(4.478, 4.264, 5.419, 5.528, 7.224, 7.851), 
(0.583, -0.709, -1.073, -2.734, 0.445, -1.499), 
(-2.043, -0.892, -3.785, -2.29, 0.89, -3.184), 
(1.023, 1.392, -1.04, -0.012, -0.046, -1.396), 
(-1.755, -2.583, -3.162, -4.917, -2.364, -3.783), 
(7.431, 6.675, 7.055, 6.107, 9.465, 9.174), 
(0.49, 0.103, 1.095, 1.505, 3.157, 0.897), 
(-1.994, -4.471, -2.589, -5.069, -2.096, -4.159), 
(3.995, 1.333, 2.483, 0.153, 4.211, 0.139), 
(7.21, 5.255, 7.145, 4.434, 8.698, 8.416), 
(7.477, 7.109, 7.365, 8.425, 10.338, 12.498), 
(6.221, 6.583, 6.429, 4.331, 9.413, 6.475), 
(1.059, -1.886, -1.064, -1.874, -1.601, -0.644), 
(1.579, 3.623, 6.117, 5.074, 6.714, 9.272), 
(9.304, 6.635, 6.575, 5.476, 12.478, 8.666), 
(0.72, -2.156, -0.234, -1.79, -1.511, -3.638), 
(-20.856, -16.609, -18.237, -18.617, -21.95, -23.638), 
(3.475, 3.351, 3.961, 4.654, 6.578, 9.528), 
(-1.032, 1.345, 0.464, 1.907, 2.51, 3.214), 
(9.755, 6.04, 11.509, 6.478, 9.147, 7.848), 
(-0.792, -4.184, -2.501, -1.901, -3.01, -5.442), 
(6.358, 4.677, 8.123, 9.49, 8.615, 9.676), 
(2.022, 1.92, 2.07, 1.393, 3.306, 3.109), 
(-1.238, -1.23, -1.492, -1.645, -0.011, -2.996), 
(1.626, 2.14, 5.281, 6.152, 1.056, 2.258), 
(0.296, 1.579, 2.227, 0.765, 2.515, 1.759), 
(5.631, 6.231, 7.483, 7.987, 6.353, 8.534), 
(-1.865, -1.538, -1.373, -0.011, -1.528, 0.102), 
(-10.789, -11.711, -10.88, -9.427, -12.503, -10.29), 
(2.304, 4.91, 4.363, 7.908, 9.329, 9.922), 
(2.43, 3.365, 5.861, 5.249, 8.17, 6.473), 
(7.87, 4.202, 10.794, 9.768, 7.139, 7.241), 
(-1.343, -2.805, -2.445, -0.098, -3.928, -1.499), 
(-15.924, -15.11, -17.513, -18.454, -16.039, -18.379), 
(1.657, 3.573, 1.947, 3.537, 5.115, 2.246), 
(5.76, 9.524, 5.522, 7.259, 6.736, 6.745), 
(2.774, 2.339, 2.833, 3.525, 1.273, 2.068), 
(7.435, 9.69, 8.69, 9.318, 10.681, 18.863), 
(5.723, 4.451, 4.091, 4.79, 8.177, 9.595), 
(1.71, 3.157, 3.145, 3.423, 1.353, 6.201), 
(0.95, 0.8, 2.153, 2.193, 2.809, 3.317), 
(-0.171, 1.031, 3.932, 10.544, 4.631, 11.116), 
(-4.889, -4.031, -4.804, -6.563, -4.895, -5.706), 
(3.359, 0.58, 1.263, -4.405, -1.62, -6.371), 
(0.765, 2.724, 2.187, -0.324, -0.899, -2.63), 
(7.471, 7.545, 8.415, 4.818, 7.102, 9.571), 
(5.039, 2.71, 0.694, -1.923, 1.964, 3.453), 
(1.399, 0.977, 0.365, 0.016, 4.988, 6.5), 
(0.4, -1.019, -0.923, -1.848, -4.931, -8.167), 
(-2.858, -3.849, -2.387, 0.248, -4.933, -6.941), 
(-6.794, -7.548, -8.824, -8.883, -8.008, -13.423), 
(-7.579, -5.046, -9.344, -12.387, -7.242, -8.726), 
(3.078, 6.027, 1.887, 6.848, 6.871, 10.459), 
(1.39, 2.126, 1.753, 2.288, 0.771, 0.375), 
(-1.425, -1.77, -2.219, -4.582, 0.156, -1.386), 
(-0.06, -3.222, -3.517, -6.439, -1.94, -2.234), 
(-1.607, -4.247, -3.33, -8.423, -3.383, -6.857), 
(1.419, 0.855, -2.508, -5.949, -0.033, -3.395), 
(3.801, 3.868, 1.762, 4.301, 5.363, 8.423), 
(-1.067, -3.011, -4.259, -4.151, -3.671, -4.911), 
(-2.302, -1.652, -3.411, -7.034, -4.755, -6.465), 
(-0.659, -1.697, -3.445, -5.81, 0.339, -2.142), 
(2.226, 7.934, 7.742, 7.644, 6.226, 11.271), 
(5.843, 3.349, 1.178, -0.771, 4.299, 0.013), 
(9.871, 14.371, 11.589, 11.89, 10.598, 18.001), 
(10.808, 6.838, 6.279, 2.77, 11.299, 13.283), 
(2.164, 1.821, 1.456, 1.025, 0.555, -0.792), 
(8.542, 2.672, 8.066, 5.616, 7.803, 11.396), 
(8.541, 6.444, 5.49, -0.016, 10.046, 5.156), 
(7.445, 5.304, 5.751, 1.885, 1.983, 3.2), 
(9.195, 7.289, 6.064, 5.246, 5.777, 4.265), 
(5.518, 5.668, 6.173, 9.864, 7.308, 9.809), 
(4.244, 4.14, 2.657, 3.841, 4.193, 5.049), 
(0.782, -3.396, -0.567, -1.759, -4.151, -8.536), 
(-4.193, -4.51, -1.112, -2.69, -2.455, -5.02), 
(0.535, 2.894, 0.553, -0.556, -0.35, 0.769), 
(-3.016, -6.136, -5.256, -6.647, -8.102, -10.682), 
(3.088, 4.192, 2.978, 3.615, 5.756, 8.123), 
(-1.406, -2.701, 0.804, -1.503, -2.44, -2.764), 
(1.363, -3.78, 2.436, -1.288, -1.087, -6.708), 
(-4.933, -6.897, -5.083, -6.223, -7.719, -8.766), 
(0.974, 1.771, 2.362, 0.447, 0.574, -2.451), 
(-0.543, -1.187, -0.6, -0.244, -1.752, -2.566), 
(-3.242, -5.573, -5.543, -6.63, -4.141, -5.96), 
(1.505, 3.361, -0.465, 1.06, 1.553, 5.386), 
(-3.272, -2.63, -5.361, -6.026, -6.719, -9.055), 
(8.369, 9.027, 10.631, 12.292, 9.712, 14.804), 
(0.534, -2.431, -1.345, -2.141, -1.256, -7.258), 
(-2.234, -0.648, -3.834, -4.974, -3.063, -5.402), 
(-1.912, -2.782, -3.734, -3.016, -2.886, -7.779), 
(0.884, 1.775, -0.461, -0.415, 0.138, 3), 
(8.238, 12.624, 9.286, 9.95, 13.152, 18.008), 
(3.075, 3.033, 2.848, 2.633, 0.806, 0.443), 
(-0.032, -2.125, -1.164, -2.952, -2.822, -7.604), 
(-0.941, -1.618, -2.125, -2.107, -0.057, -4.617), 
(2.267, 4.233, 0.592, 1.363, 2.95, 2.005), 
(2.204, 0.171, -1.405, -1.322, -2.184, -1.419), 
(1.142, -0.089, 2.67, 3.191, 2.294, 2.456), 
(-0.359, -0.632, -1.625, -1.762, -1.309, -1.936), 
(-4.554, -4.019, -5.898, -5.622, -6.751, -8.87), 
(2.385, 2.951, 0.436, 2.17, 0.627, -0.259), 
(6.37, 7.393, 3.25, 4.775, 4.33, 7.685), 
(3.83, 2.989, -0.61, 2.097, 6.161, 2.991), 
(2.603, 2.725, -0.65, -0.005, 2.647, -2.085), 
(8.727, 8.135, 3.125, 5.884, 7.297, 5.561), 
(6.574, 5.972, 4.23, 4.366, 1.297, 0.434), 
(1.288, 1.039, -1.445, -1.298, 3.014, 4.53), 
(3.222, 5.958, 2.876, 5.19, 4.539, 2.056), 
(4.514, 2.235, -1.165, -0.756, -1.696, -3.842), 
(-5.805, -8.259, -8.605, -8.729, -8.587, -11.064), 
(0.529, 2.069, 6.331, 2.919, 4.296, 2.363), 
(-5.667, -9.652, -2.848, -6.535, -4.266, -8.188), 
(3.247, 2.939, 1.023, 2.565, 3.578, 4.127), 
(0.81, 0.266, -0.323, -0.455, 0.203, 0.473), 
(-3.111, -2.948, -3.206, -1.897, -1.24, -4.079), 
(8.599, 10.421, 13.763, 13.965, 12.001, 15.91), 
(6.537, 7.02, 6.44, 6.475, 7.894, 7.747), 
(2.572, 0.883, 6.101, 3.212, 0.356, -2.826), 
(0.141, -3.448, -0.202, -2.966, -0.368, 0.307), 
(-0.036, 0.325, 3.316, 0.491, 1.449, 1.023), 
(1.527, 3.743, 4.04, 2.63, 0.052, 1.556), 
(3.572, 3.055, 8.672, 4.842, 1.335, 1.29), 
(2.657, 2.922, -0.215, 1.457, 1.174, 4.171), 
(0.377, -2.326, 0.127, -1.066, 0.665, -0.524), 
(-27.432, -30.222, -28.937, -29.737, -28.759, -31.647), 
(-5.965, -8.029, -3.797, -5.171, -6.473, -9.001), 
(4.453, 8.826, 5.054, 7.178, 4.23, 9.451), 
(5.875, 4.422, 6.552, 4.958, 8.64, 0.792), 
(10.319, 6.894, 7.987, 8.474, 6.696, 9.701), 
(3.618, 3.042, 3.377, 2.703, 7.402, 1.058), 
(4.837, 1.263, 3.149, 2.319, 1.405, 0.963), 
(-1.087, -2.732, -1.048, -1.943, -2.399, -4.264), 
(4.255, 4.798, 4.42, 6.523, 7.873, 7.57), 
(-0.595, -0.687, 0.339, -2.364, -2.501, -4.599), 
(-1.239, -4.164, -3.125, -3.795, -2.021, -6.744), 
(1.645, 2.669, 0.36, 1.47, 0.136, 0.351), 
(-0.599, 2.145, -0.591, -1.4, -2.3, -3.174), 
(-3.107, -4.957, -1.765, -3.096, -3.603, -4.12), 
(2.214, 0.711, 2.876, 3.613, 4.55, 4.561), 
(4.143, 4.466, 5.434, 4.587, 6.139, 4.95), 
(1.035, -0.816, 0.916, -0.141, -1.094, -0.622), 
(3.565, 0.897, 2.793, 2.165, 3.728, -0.255), 
(4.111, 4.907, 2.827, 3.65, 2.569, 6.483), 
(2.694, 3.298, 1.056, 2.262, 3.449, 4.488), 
(-1.41, -2.253, -1.654, -2.217, -1.726, -4.546), 
(1.856, 4.883, 2.927, 4.011, 1.469, 4.896), 
(2.041, 0.638, 2.731, 2.766, 1.175, -0.008), 
(-3.103, -1.027, -1.282, -1.834, -0.36, 0.353), 
(-6.967, -6.778, -6.426, -5.75, -7.337, -5.935), 
(-2.852, -1.2, -2.077, 1.382, -2.97, -2.525), 
(-2.09, -0.277, 0.943, 0.897, -0.376, 0.642), 
(-5.952, -8.875, -4.873, -7.443, -6.915, -5.938), 
(1.745, 2.192, 1.459, 2.064, 0.849, 1.98), 
(2.403, 3.293, 3.115, 2.377, 5.801, 4.294), 
(-0.871, -2.252, -5.496, -2.197, -4.27, -3.506), 
(1.004, 7.17, 4.03, 4.624, 9.776, 8.898), 
(-0.176, -1.506, -2.462, -0.648, -0.173, 1.534), 
(-4.601, -4.398, -2.217, -0.918, -4.003, -9.315), 
(-11.044, -14.518, -10.881, -9.876, -14.738, -17.533), 
(-10.237, -10.179, -7.356, -6.605, -9.288, -13.601), 
(-6.672, -6.423, -9.83, -6.301, -3.469, -5.021), 
(2.341, 5.101, 3.889, 3.683, 4.969, 9.738), 
(0.664, 0.675, -0.738, -1.182, 0.222, 3.996), 
(10.263, 8.196, 7.684, 4.006, 17.695, 10.058), 
(9.572, 10.948, 8.624, 12.717, 11.597, 12.864), 
(8.762, 6.515, 3.97, 3.776, 13.291, 13.481), 
(1.576, 1.814, 0.7, 0.787, 0.582, -0.45), 
(2.693, 3.27, 1.454, 2.024, 2.379, 1.532), 
(-3.387, -4.556, -3.555, -4.776, -6.57, -6.921), 
(0.648, 4.079, 1.542, 4.14, 1.864, 3.793), 
(0.8, 2.682, 1.371, 1.955, 2.319, 3.278), 
(-0.557, -1.875, -0.339, -1.985, -1.161, -0.276), 
(1.162, 0.695, 0.902, -0.057, 1.965, 1.405), 
(-4.224, -2.585, -3.289, -5.14, -3.939, -6.961), 
(3.415, 10.199, 4.523, 4.915, 0.64, 8.875), 
(15.647, 8.054, 10.597, 4.392, 20.598, 8.837), 
(9.056, 5.305, 4.657, 1.686, 5.7, 3.945), 
(1.218, -1.9, 0.737, -1.644, -2.961, -3.729), 
(-1.422, -2.16, -0.324, 1.553, -6.78, -4.668), 
(-0.68, -1.54, 1.045, 2.118, -0.094, -2.534), 
(-4.123, -4.838, -4.358, -4.773, -4.333, -6.968), 
(0.65, 2.032, 2.33, 3.273, 2.114, 1.066), 
(-3.806, -1.736, -3.237, -1.802, -2.295, -5.686), 
(0.474, 1.318, 0.959, 3.626, -0.852, 3.796), 
(1.241, 2.779, -0.733, -0.765, 2.567, 5.076), 
(5.768, 7.472, 2.71, 3.46, 6.961, 11.796), 
(3.763, 1.764, 3.116, 1.778, 4.463, 2.532), 
(7.108, 1.211, 6.653, 1.998, 6.481, 5.84), 
(-0.523, -3.373, 4.35, 2.025, -1.499, -3.398), 
(1.796, 0.864, 4.039, 2.927, 0.279, 1.703), 
(-1.924, -3.578, -0.799, 0.903, -0.723, -5.006), 
(4.13, 4.685, 3.294, 2.947, 6.024, 5.485), 
(2.247, -1.459, 1.09, -0.175, 1.495, 1.012), 
(2.353, 0.654, 0.75, -2.022, 1.874, 1.4), 
(1.583, 2.681, 4.376, 3.783, 7.376, 8.541), 
(2.118, -0.401, -0.392, -0.426, 4.835, 1.732), 
(3.742, 2.83, 3.141, 1.502, 9.019, 3.573), 
(-0.77, -0.964, -3.266, -2.295, -3.333, -1.591), 
(0.061, 1.171, 1.107, 3.754, 2.044, 2.552), 
(5.679, 2.423, 8.401, 3.383, 6.527, 1.942), 
(0.864, 1.016, -0.413, -0.012, -0.577, -1.74), 
(-6.106, -6.009, -3.257, -5.716, -3.527, -7.083), 
(-0.02, -1.006, 1.512, 0.516, 1.014, -2.408), 
(0.771, 0.029, 0.225, -0.301, 0.393, -3.953), 
(-5.416, -3.615, -1.696, -1.765, -3.325, -7.45), 
(2.009, 1.025, 2.01, 2.441, 3.578, 3.414), 
(2.287, 2.192, 3.12, 3.153, 6.353, 6.816), 
(0.224, -1.968, 1.45, -1.743, 3.589, 2.678), 
(-0.793, -1.193, 1.729, -0.789, 4.431, 2.486), 
(-3.526, -6.683, -5.645, -6.31, -2.285, -3.605), 
(-3.557, -2.659, -0.143, 1.92, 1.186, 0.385), 
(2.789, 1.595, 0.145, -1.16, 1.436, 1.3), 
(3.483, 2.72, 2.699, 4.266, 2.575, 5.394), 
(-0.935, 1.088, 3.784, 3.617, 3.309, 2.032), 
(1.713, 1.544, 2.444, 3.002, 7.478, 5.323), 
(0.49, 0.631, 0.652, 2.323, 4.478, 2.371), 
(1.83, 4.923, 2.241, 0.081, 9.806, 11.24), 
(3.075, 4.124, 3.304, 3.045, 8.323, 10.822), 
(0.93, 0.489, 1.966, 0.702, 2.954, 1.251), 
(1.631, 1.435, 0.562, -0.392, 0.642, 2.108), 
(-7.097, -7.059, -5.444, -6.746, -6.361, -7.019), 
(-0.791, 0.862, 1.63, 3.356, 1.109, 2.517), 
(-1.507, -1.3, 2.037, -0.161, 0.176, -2.064), 
(2.167, 2.889, 3.092, 1.042, -0.811, 0.356), 
(3.185, 3.989, 3.827, 2.136, 5.905, 7.626), 
(3.627, 4.285, 4.551, 3.236, -0.186, -2.24), 
(4.818, 5.412, 6.484, 5.497, 11.007, 10.899), 
(5.759, 6.391, 4.604, 1.77, 8.046, 7.863), 
(-3.718, -5.028, -1.287, -2.706, -8.357, -9.128), 
(-7.221, -8.026, -6.079, -6.357, -11.481, -13.567), 
(2.634, 5.664, 2.478, 3.801, 3.177, 4.863), 
(0.573, 1.698, 2.749, 2.871, 3.398, 3.974), 
(-1.076, -4.837, 2.041, 0.985, -4.407, -7.444), 
(2.736, 1.792, 5.07, 4.927, 3.512, 1.176), 
(-0.73, -2.294, 0.944, 0.599, -0.48, -2.917), 
(3.458, 3.915, 5.073, 4.204, 8.21, 6.162), 
(0.16, -1.9, -2.743, -3.289, -2.876, -7.938), 
(-3.896, -4.791, -2.646, -2.679, -8.229, -9.25), 
(-4.288, -1.378, 0.946, 0.443, 0.62, -4.083), 
(6.468, 8.985, 10.118, 8.851, 12.461, 14.845), 
(4.151, 4.198, 3.934, 4.268, 4.76, 0.986), 
(3.253, 5.146, 5.725, 7.689, 9.112, 6.121), 
(1.994, -0.914, 2.336, 2.313, 6.135, 5.403), 
(6.223, 7.708, 7.145, 5.608, 8.662, 6.067), 
(-0.56, -4.023, -3.352, -4.473, -5.66, -5.907), 
(-1.746, 0.444, -3.676, -3.771, -4.572, -5.102), 
(-6.223, -2.259, -2.999, -2.586, -6.425, -5.711), 
(-0.221, -2.008, -0.765, -3.536, 2.383, 4.865), 
(8.573, 8.864, 4.827, 7.425, 7.41, 8.318), 
(4.246, 3.733, 4.933, 4.324, 2.802, 4.46), 
(5.506, 0.536, 2.751, 2.232, 6.603, 1.28), 
(-2.107, -5.359, -3.255, -5.87, -5.568, -9.491), 
(-3.929, -1.437, -4.596, -5.93, -5.009, -2.639), 
(-4.884, -5.916, -9.08, -9.272, -7.955, -5.213), 
(-17.803, -19.715, -19.397, -20.572, -22.085, -24.229), 
(0.281, 0.749, 3.292, 5.404, 5.758, 8.828), 
(0.24, 5.96, 2.357, 6.582, 2.856, 6.314), 
(6.928, 9.63, 0.353, -1, 10.609, 12.779), 
(3.191, 2.7, -3.825, -3.565, 5.639, 7.78), 
(4.791, 1.678, 0.456, -0.137, 14.259, 10.169), 
(-5.521, -4.171, -6.504, -5.646, -4.475, -9.836), 
(-2.964, -3.032, 2.066, 5.916, -3.677, -1.45), 
(8.259, 8.58, 14.524, 15.013, 11.931, 9.307), 
(3.456, 1.923, 1.898, -0.57, 6.868, 4.419), 
(1.417, 1.529, 4.788, 4.662, 8.076, 8.332), 
(0.51, -1.984, 1.268, -0.874, 2.811, -1.096), 
(-5.686, -8.889, -0.744, -1.847, -1.383, -0.063), 
(-5.342, -3.337, -4.584, -3.849, -2.28, 3.562), 
(-3.435, -3.129, -4.911, -2.797, 2.458, 4.733), 
(3.405, 2.97, -0.107, 1.168, 23.522, 25.016), 
(2.155, 1.535, 4.693, 2.541, 21.71, 28.132), 
(6.627, -2.086, 4.712, -2.471, 14.857, 3.421), 
(3.33, 1.4, 2.272, -0.812, 27.725, 27.691), 
(0.374, 4.867, 6.838, 8.93, -1.75, -6.063), 
(-3.965, -3.881, -2.818, 0.69, -16.238, -15.186), 
(-5.921, -5.78, 0.55, 0.793, -13.581, -13.086), 
(2.32, 1.314, 0.397, -0.292, 13.55, 14.093), 
(-1.432, -1.687, -0.71, -2.871, -3.083, -11.266), 
(1.031, 5.587, 6.809, 5.84, 8.107, 8.692), 
(-5.049, -4.426, -2.115, -4.987, -5.43, -13.151), 
(-10.262, -1.864, -6.128, -2.383, -9.861, -10.966), 
(-11.885, -8.997, -6.261, -6.974, -17.626, -26.662), 
(-7.873, 0.295, 4.889, 10.235, -6.442, -6.848), 
(28.876, 16.623, 13.856, 6.366, 36.281, 44.178), 
(-0.661, -6.205, -1.868, -2.357, -10.7, -22.617), 
(-4.18, -3.414, -2.14, -4.054, -10.893, -18.508), 
(2.609, 6.056, 3.461, 7.693, 6.752, 16.35), 
(10.417, 3.996, 5.641, 3.409, 5.282, 0.723), 
(2.7, 2.145, -4.58, -5.577, 1.509, -0.103), 
(2.43, -2.544, -1.136, -2.371, -8.418, -8.474), 
(-1.651, -3.132, -1.788, -5.003, -9.208, -11.753), 
(-14.046, -12.454, -15.685, -13.635, -16.703, -21.848), 
(2.512, 4.562, 1.651, 8.04, 18.434, 20.668), 
(7.413, 6.82, 4.369, 2.903, 13.108, 16.488), 
(8.349, 5.828, 5.767, 6.537, 7.839, 6.422), 
(4.689, 2.893, 5.339, -2.136, 3.003, -1.092), 
(-0.817, -1.58, 0.928, 2.423, -9.809, -13.519), 
(11.381, 7.42, 10.504, 11.046, 9.307, 10.751), 
(7.068, 2.793, 3.303, 0.09, -3.648, -10.54), 
(4.811, -0.771, -1.453, -3.009, -3.421, -7.75), 
(-3.16, -7.258, -3.766, -5.568, -12.317, -16.436), 
(-11.297, -13.582, -13.453, -12.944, -14.796, -16.954), 
(-2.965, 1.137, -0.025, 1.392, 0.407, 0.278), 
(-9.34, -7.059, -9.285, -8.517, -15.14, -15.768), 
(0.293, 3.527, -0.707, 3.05, 9.511, 16.383), 
(8.481, 7.517, 8.032, 8.832, 26.684, 27.315), 
(-3.266, -3.21, -3.041, -3.001, -10.573, -13.066), 
(0.105, -5.06, -1.173, -3.24, 2.15, 2.503), 
(-1.953, -3.955, -2.055, -0.67, -1.908, -2.88), 
(-0.757, -0.992, -1.163, -1.663, -0.972, 2.179), 
(9.121, 8.259, 6.579, 8.521, 14.038, 13.818), 
(6.254, 8.412, 12.137, 10.713, 24.635, 22.235), 
(5.604, 5.224, 2.741, 1.195, 6.514, 5.298), 
(9.119, 4.383, 5.46, 3.056, 13.291, 9.699), 
(4.004, 4.243, 7.455, 4.546, 5.773, 6.775), 
(0.526, -0.617, -0.024, -3.331, 5.636, 0.541), 
(9.129, 7.795, 8.59, 7.204, 15.075, 10.39), 
(5.795, 2.287, 3.886, 3.073, 8.085, 3.068), 
(5.794, 1.621, 11.762, 9.216, 0.228, 0.821), 
(8.603, 2.777, 3.996, 1.113, 14.311, 8.205), 
(1.995, 3.559, 4.99, 2.531, -1.885, -2.06), 
(1.159, 0.28, 0.839, 1.008, -1.429, -2.411), 
(1.132, -0.473, -1.023, 0.612, -7.714, -6.502), 
(-1.107, -1.283, 1.546, -0.509, -0.095, 3.185), 
(3.993, 1.838, 8.375, 6.456, 0.961, 1.713), 
(-3.997, -5.794, -1.757, -3.478, -10.4, -14.774), 
(-2.847, -4.214, -1.902, -0.921, -2.419, -5.251), 
(2.067, 3.751, 6.421, 7.006, 3.511, 5.759), 
(1.156, 3.771, -0.385, -0.491, 1.949, 4.639), 
(9.221, 8.415, 13.021, 9.824, 8.77, 10.454), 
(6.308, 5.436, 3.239, 2.029, 8.494, 7.328), 
(-1.192, -3.962, -0.89, -2.014, -7.101, -8.009), 
(0.937, 0.735, 7.576, 6.662, 0.485, -0.477), 
(-3.221, -3.042, -2.084, -1.791, -3.13, -5.422), 
(-5.255, -4.932, -7.491, -6.986, -7.241, -8.1), 
(4.805, 5.573, 3.064, 4.737, 4.323, 7.919), 
(2.834, 4.102, 4.557, 4.181, 1.861, 1.368), 
(7.143, 5.587, 10.673, 9.419, 7.732, 6.628), 
(-0.885, -3.586, 1.492, -0.381, -0.824, -2.465), 
(0.739, -1.916, 2.473, 2.395, 1.192, 0.241), 
(-4.944, -2.699, -5.271, -5.723, -3.944, -4.472), 
(2.797, 2.614, 4.449, 4.361, 3.078, 4.547), 
(-0.264, 0.403, 0.812, 1.435, -0.026, -0.578), 
(5.956, 4.353, 12.15, 12.611, 7.717, 9.341), 
(0.174, 2.46, -3.187, -2.554, 0.983, -0.308), 
(2.891, 4.409, 6.129, 5.299, 6.401, 2.925), 
(1.956, 1.374, 3.888, 3.285, 0.528, -0.223), 
(-4.688, -4.811, -4.95, -5.699, -5.851, -8.216), 
(-1.352, -0.782, -0.028, -0.231, -3.071, -1.932)
])

"""
Here, I compute vector of mean returns and the Var-Cov matrix of the
returns. These numbers will serve as inputs in the mean variance
portfolio analysis.
"""

E = Ret.mean(0)     # E is N*1
print(E)
SIGMA = np.cov(Ret.T) # SIGMA is N*N
print(SIGMA)
N = len(E)          # Number of portfolios/Assets
print(N)

#%%
"-------------------------------------------------------------------------"

"""
LAGRANGIAN APPROACH WITH CLOSED FORM SOLUTIONS
"""

"MATERIAL FOR TOPIC 2"
"This section implements the solutions we found in our lecture notes."

SIGMA_inv = np.linalg.inv(SIGMA)

A = E.dot(SIGMA_inv).dot(E.T)
print(A)
B = E.dot(SIGMA_inv).dot(np.ones((N,1)))
print(B)
C = np.ones((1,N)).dot(SIGMA_inv).dot(np.ones((N,1)))
print(C)

"""
% mu=1; % that is, target is a 1% return (Here I just picked an arbitrary number)
% % Vector of weights is (note: these weights are in decimals, i.e. 0.5 stands for 50%)
% w=inv(SIGMA)*(E*(C*mu-B)+1*(A-B*mu))/(A*C-B^2);
% var_p=(C*mu^2-2*B*mu+A)/(A*C-B^2);
"""
#%%
"""
Spanning the entire mean variance frontier. Two ways:
"""

" a) Just consider a set of mu's and plot the corresponding mean and std. "

"minimum variance portfolio (formulas straigtht from the notes)"
w_minvar =  SIGMA_inv.dot(np.ones((N,1)))/C
mu_minvar = B/C
SD_minvar = (1/C)**(0.5)


mu = np.array( [range(-200, 201, 1)] ) / 20 # that is, I will consider a target return from -10% to +10%

MEAN_SD = np.full([mu.size, 2], None)
    
mu = np.asarray(mu, dtype=float).ravel()
A, B, C = float(A), float(B), float(C)
den = A*C - B**2

MEAN_SD = np.empty((mu.size, 2), dtype=float)
for i, m in enumerate(mu):
    vp = (C*m*m - 2*B*m + A) / den
    MEAN_SD[i, 0] = m
    MEAN_SD[i, 1] = np.sqrt(max(vp, 0.0))
    
    
plt.plot(MEAN_SD[:,1], MEAN_SD[:,0], color = "r", linestyle='-.')
plt.plot(SD_minvar,mu_minvar, color='r', marker='o', markerfacecolor='r', markersize=10) # minimum variance portfolio case E0     
plt.xlabel('Standard Deviation (in %)')
plt.ylabel('Expected Return (in %)')  
plt.show()

#%%
"""
% b) Create 2 arbitrary portfolio that are on the frontier, and use the fact
% that at any combination of the two is also on the frontier (See Cochrane,
% p.83): to do
"""

""" Using optimizers (very useful when you want to calculate optimal portfolios with constraints) """
"MATERIAL FOR TOPIC 3"

" 1: Replicate Analytical Result Min Variance for a given return "

mu = 1 # For a given target return

" a) Re-write the minimum variance problem without constraints "
def f(w):
    return w.T.dot(SIGMA).dot(w)

w0 = (1.0/N) * np.ones(N)   # starting weights (arbitrary here - just used equal-weight as starting point)
cons = ({'type': 'eq', 'fun': lambda w: float(E.ravel().dot(w) - mu)}, # portfolio constraint: target expected return = mu
        {'type': 'eq', 'fun': lambda w: float(np.sum(w) - 1.0)})# portfolio constraint: summation of weights should be 1

result = optimize.minimize(f, w0, method='SLSQP', constraints = cons)

result.x # This is the optimal portfolio choice
fval0 =result.fun # This is the optimal function value
fval0

#%%

" b) minimum variance problem with short sale constraints "

bnds = tuple((0, 1) for w in range(N)) # does not allow short sale

result = optimize.minimize(f, w0, method='SLSQP', constraints = cons, bounds = bnds)

result.x # this is the optimal portfolio choice
fval1 =result.fun # this is the optimal function value
fval1

print(fval1/fval0) # this number just shows how bigger the variance of the portfolio with constraint is relative to the variance of the portfolio without constraint

#%%
" 2: Find the Mean Variance Efficient Portfolio (that is, the portfolio with Maximum Sharpe ratio) "

"a) No short sale constraints"
Rf=1/12
print(Rf)
def f(w):
    return - (w.T.dot(E-Rf)) /  (w.T.dot(SIGMA).dot(w))**(0.5) 
# note I introduce a minus here because we want to maximize, not minimize 

cons = ({'type': 'eq', 'fun': lambda w:  np.sum(w) - 1}) # portfolio constraint: summation of weights should be 1

result = optimize.minimize(f, w0, method='SLSQP', constraints = cons)

result.x # This is the optimal portfolio choice
fvalSR0 =result.fun # This is the optimal function value
fvalSR0


"b) With short sale constraints"
result = optimize.minimize(f, w0, method='SLSQP', constraints = cons, bounds = bnds)

result.x # This is the optimal portfolio choice
fvalSR1 =result.fun # This is the optimal function value
fvalSR1

print(-fvalSR1/fvalSR0) # this number just shows the decrease in the Sharpe ratio by impositing the constraint.


"""
3: Find portfolio that gives the maximum utility (no Rf Asset).

    TO BE ADDED need to specify an utility function. You will do this in
    an homework assignment.
"""


